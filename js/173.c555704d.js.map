{"version":3,"file":"js/173.c555704d.js","mappings":"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","sources":["webpack://zhizhi_cms/./src/views/zhizhi/editAnswer.vue","webpack://zhizhi_cms/./src/views/zhizhi/editAnswer.vue?0d7c"],"sourcesContent":["import \"core-js/modules/es.array.includes.js\";\nimport { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\n\nconst _hoisted_1 = /*#__PURE__*/_createTextVNode(\"查询\");\n\nconst _hoisted_2 = {\n  m: \"4\"\n};\n\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\"删除回答\");\n\nconst _hoisted_4 = /*#__PURE__*/_createTextVNode(\"修改问题\");\n\nconst _hoisted_5 = {\n  class: \"dialog-footer\"\n};\n\nconst _hoisted_6 = /*#__PURE__*/_createTextVNode(\"取消\");\n\nconst _hoisted_7 = /*#__PURE__*/_createTextVNode(\"确定\");\n\nimport { reactive, toRefs, ref, computed, onMounted, watch } from 'vue';\nimport { getQuestions, delAnswer, editQuestion } from '@/request/api';\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'editAnswer',\n\n  setup(__props) {\n    const state = reactive({\n      tableData: [],\n      form: {},\n      selectData: {}\n    });\n    let {\n      tableData,\n      form,\n      selectData\n    } = toRefs(state);\n    const dialogFormVisible = ref(false);\n    const formLabelWidth = '140px';\n    const search = ref(''); // 计算属性函数代替过滤器，根据搜索内容过滤answers数组\n\n    const filterAnswersFun = computed(() => {\n      return function (answers) {\n        return answers.filter(data => {\n          data.nickName = data.nickName || '';\n          return !search.value || data.nickName.toLowerCase().includes(search.value.toLowerCase());\n        });\n      };\n    });\n\n    const getQuestionData = () => {\n      getQuestions().then(res => {\n        tableData.value = res.data;\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    getQuestionData();\n\n    const handleDelete = (row, index) => {\n      delAnswer(row.answer_id).then(() => {\n        // 删除tableData中选中的回答，但表格会收起来像刷新过\n        // 这样不如直接获取新tableData简单了\n        tableData.value.forEach(element => {\n          if (element.question_id === row.question_id) {\n            element.answers.splice(index, 1);\n          }\n        });\n      }).catch(err => {\n        console.log('err', err);\n      });\n    };\n\n    const handleEditQuestion = index => {\n      dialogFormVisible.value = true;\n      form.value = tableData.value[index];\n    };\n\n    const handleConfirm = () => {\n      dialogFormVisible.value = false; // 数据已修改，需要一个接口修改数据库数据\n\n      editQuestion(form.value).then(res => {\n        console.log(res);\n      }).catch(err => {\n        console.log('err', err);\n      });\n    };\n\n    const handleClick = () => {\n      search.value = '';\n    };\n\n    onMounted(() => {\n      // 选中箭头i标签节点添加点击事件\n      setTimeout(() => {\n        const arrows = document.querySelector('.el-table__body')?.getElementsByTagName('i');\n\n        for (let i = 0; i < tableData.value.length; i++) {\n          arrows[i].addEventListener('click', handleClick);\n        }\n      }, 100);\n    }); // 根据问题和描述查询内容\n\n    const onSubmit = () => {\n      let arr = tableData.value;\n\n      if (selectData.value.title || selectData.value.desc) {\n        if (selectData.value.title) {\n          arr = arr.filter(data => data.title.indexOf(selectData.value.title) !== -1);\n        }\n\n        if (selectData.value.desc) {\n          arr = arr.filter(data => data.desc.indexOf(selectData.value.desc) !== -1);\n        }\n      }\n\n      tableData.value = arr;\n    };\n\n    watch([() => selectData.value.title, () => selectData.value.desc], () => {\n      if (selectData.value.title == '' && selectData.value.desc == '') {\n        getQuestionData();\n      }\n    });\n    return (_ctx, _cache) => {\n      const _component_el_input = _resolveComponent(\"el-input\");\n\n      const _component_el_form_item = _resolveComponent(\"el-form-item\");\n\n      const _component_el_button = _resolveComponent(\"el-button\");\n\n      const _component_el_form = _resolveComponent(\"el-form\");\n\n      const _component_el_table_column = _resolveComponent(\"el-table-column\");\n\n      const _component_el_table = _resolveComponent(\"el-table\");\n\n      const _component_el_dialog = _resolveComponent(\"el-dialog\");\n\n      return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_el_form, {\n        inline: true,\n        model: _unref(selectData),\n        class: \"demo-form-inline\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_form_item, {\n          label: \"问题\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_input, {\n            modelValue: _unref(selectData).title,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _unref(selectData).title = $event),\n            placeholder: \"请输入关键字\"\n          }, null, 8, [\"modelValue\"])]),\n          _: 1\n        }), _createVNode(_component_el_form_item, {\n          label: \"问题描述\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_input, {\n            modelValue: _unref(selectData).desc,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _unref(selectData).desc = $event),\n            placeholder: \"请输入关键字\"\n          }, null, 8, [\"modelValue\"])]),\n          _: 1\n        }), _createVNode(_component_el_form_item, null, {\n          default: _withCtx(() => [_createVNode(_component_el_button, {\n            type: \"primary\",\n            onClick: onSubmit\n          }, {\n            default: _withCtx(() => [_hoisted_1]),\n            _: 1\n          })]),\n          _: 1\n        })]),\n        _: 1\n      }, 8, [\"model\"]), _createVNode(_component_el_table, {\n        data: _unref(tableData),\n        border: \"\",\n        style: {\n          \"width\": \"100%\",\n          \"margin-top\": \"20px\"\n        }\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_table_column, {\n          type: \"expand\"\n        }, {\n          default: _withCtx(props => [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_table, {\n            data: _unref(filterAnswersFun)(props.row.answers)\n          }, {\n            default: _withCtx(() => [_createVNode(_component_el_table_column, {\n              label: \"回答\",\n              \"show-overflow-tooltip\": \"\"\n            }, {\n              default: _withCtx(scope => [_createElementVNode(\"div\", null, _toDisplayString(scope.row.answer), 1)]),\n              _: 1\n            }), _createVNode(_component_el_table_column, {\n              label: \"回答ID\",\n              prop: \"answer_id\",\n              width: \"130\"\n            }), _createVNode(_component_el_table_column, {\n              label: \"回答用户\",\n              prop: \"nickName\",\n              width: \"100\"\n            }), _createVNode(_component_el_table_column, {\n              label: \"点赞数\",\n              prop: \"likes\",\n              width: \"80\"\n            }), _createVNode(_component_el_table_column, {\n              align: \"center\"\n            }, {\n              header: _withCtx(() => [_createVNode(_component_el_input, {\n                modelValue: search.value,\n                \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => search.value = $event),\n                size: \"small\",\n                placeholder: \"输入用户名搜索回答\"\n              }, null, 8, [\"modelValue\"])]),\n              default: _withCtx(scope => [_createVNode(_component_el_button, {\n                size: \"small\",\n                type: \"danger\",\n                onClick: $event => handleDelete(scope.row, scope.$index)\n              }, {\n                default: _withCtx(() => [_hoisted_3]),\n                _: 2\n              }, 1032, [\"onClick\"])]),\n              _: 1\n            })]),\n            _: 2\n          }, 1032, [\"data\"])])]),\n          _: 1\n        }), _createVNode(_component_el_table_column, {\n          prop: \"title\",\n          label: \"问题\",\n          width: \"250\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"question_id\",\n          label: \"问题ID\",\n          width: \"180\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"desc\",\n          label: \"问题描述\",\n          \"show-overflow-tooltip\": \"\"\n        }), _createVNode(_component_el_table_column, {\n          label: \"操作\",\n          width: \"180\"\n        }, {\n          default: _withCtx(scope => [_createVNode(_component_el_button, {\n            size: \"small\",\n            type: \"danger\",\n            onClick: $event => handleEditQuestion(scope.$index)\n          }, {\n            default: _withCtx(() => [_hoisted_4]),\n            _: 2\n          }, 1032, [\"onClick\"])]),\n          _: 1\n        })]),\n        _: 1\n      }, 8, [\"data\"]), _createVNode(_component_el_dialog, {\n        modelValue: dialogFormVisible.value,\n        \"onUpdate:modelValue\": _cache[7] || (_cache[7] = $event => dialogFormVisible.value = $event),\n        title: \"修改问题\"\n      }, {\n        footer: _withCtx(() => [_createElementVNode(\"span\", _hoisted_5, [_createVNode(_component_el_button, {\n          onClick: _cache[6] || (_cache[6] = $event => dialogFormVisible.value = false)\n        }, {\n          default: _withCtx(() => [_hoisted_6]),\n          _: 1\n        }), _createVNode(_component_el_button, {\n          type: \"primary\",\n          onClick: handleConfirm\n        }, {\n          default: _withCtx(() => [_hoisted_7]),\n          _: 1\n        })])]),\n        default: _withCtx(() => [_createVNode(_component_el_form, {\n          model: _unref(form)\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_form_item, {\n            label: \"问题ID：\",\n            \"label-width\": formLabelWidth\n          }, {\n            default: _withCtx(() => [_createVNode(_component_el_input, {\n              modelValue: _unref(form).question_id,\n              \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => _unref(form).question_id = $event),\n              disabled: \"\"\n            }, null, 8, [\"modelValue\"])]),\n            _: 1\n          }), _createVNode(_component_el_form_item, {\n            label: \"问题：\"\n          }, {\n            default: _withCtx(() => [_createVNode(_component_el_input, {\n              modelValue: _unref(form).title,\n              \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => _unref(form).title = $event)\n            }, null, 8, [\"modelValue\"])]),\n            _: 1\n          }), _createVNode(_component_el_form_item, {\n            label: \"问题描述：\"\n          }, {\n            default: _withCtx(() => [_createVNode(_component_el_input, {\n              modelValue: _unref(form).desc,\n              \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => _unref(form).desc = $event)\n            }, null, 8, [\"modelValue\"])]),\n            _: 1\n          })]),\n          _: 1\n        }, 8, [\"model\"])]),\n        _: 1\n      }, 8, [\"modelValue\"])], 64);\n    };\n  }\n\n});","/* unplugin-vue-components disabled */import script from \"./editAnswer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./editAnswer.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["_hoisted_1","_hoisted_2","m","_hoisted_3","_hoisted_4","_hoisted_5","class","_hoisted_6","_hoisted_7","__name","setup","__props","state","tableData","form","selectData","dialogFormVisible","formLabelWidth","search","filterAnswersFun","answers","filter","data","nickName","value","toLowerCase","includes","getQuestionData","then","res","catch","err","console","log","handleDelete","row","index","answer_id","forEach","element","question_id","splice","handleEditQuestion","handleConfirm","handleClick","setTimeout","arrows","document","querySelector","getElementsByTagName","i","length","addEventListener","onSubmit","arr","title","desc","indexOf","_ctx","_cache","_component_el_input","_component_el_form_item","_component_el_button","_component_el_form","_component_el_table_column","_component_el_table","_component_el_dialog","inline","model","default","label","modelValue","$event","placeholder","_","type","onClick","border","style","props","scope","answer","prop","width","align","header","size","$index","footer","disabled","__exports__"],"sourceRoot":""}